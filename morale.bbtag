{execcc;haspermissions}
{execcc;lib}

{if;{argslength};==;0;
```
Command to calculate bonus all raid damage based on morale

Usage:
{prefix}{commandname} {realpad;morale [raidtier];20}: raid tier default to tier 4

Example:
{prefix}{commandname} 20000 3
all raid bonus damage for 20000 morale on tier 3

{prefix}{commandname} 25000
all raid bonus damage for 25000 morale on tier 4
```{return}
}

{set;~moraletab;{j;{"Bonus":{"0":0,"100":0.001,"200":0.001,"300":0.001,"400":0.001,"500":0.001,"600":0.001,"700":0.001,"800":0.001,"900":0.002,"1000":0.002,"1100":0.002,"1200":0.002,"1300":0.003,"1400":0.003,"1500":0.003,"1600":0.004,"1700":0.004,"1800":0.004,"1900":0.005,"2000":0.005,"2100":0.006,"2200":0.006,"2300":0.006,"2400":0.007,"2500":0.007,"2600":0.008,"2700":0.008,"2800":0.009,"2900":0.009,"3000":0.009,"3100":0.01,"3200":0.01,"3300":0.011,"3400":0.011,"3500":0.012,"3600":0.012,"3700":0.013,"3800":0.014,"3900":0.014,"4000":0.015,"4100":0.015,"4200":0.016,"4300":0.016,"4400":0.017,"4500":0.017,"4600":0.018,"4700":0.019,"4800":0.019,"4900":0.02,"5000":0.02,"5100":0.021,"5200":0.022,"5300":0.022,"5400":0.023,"5500":0.024,"5600":0.024,"5700":0.025,"5800":0.026,"5900":0.026,"6000":0.027,"6100":0.028,"6200":0.028,"6300":0.029,"6400":0.03,"6500":0.03,"6600":0.031,"6700":0.032,"6800":0.032,"6900":0.033,"7000":0.034,"7100":0.035,"7200":0.035,"7300":0.036,"7400":0.037,"7500":0.038,"7600":0.038,"7700":0.039,"7800":0.04,"7900":0.041,"8000":0.041,"8100":0.042,"8200":0.043,"8300":0.044,"8400":0.044,"8500":0.045,"8600":0.046,"8700":0.047,"8800":0.048,"8900":0.048,"9000":0.049,"9100":0.05,"9200":0.051,"9300":0.052,"9400":0.053,"9500":0.053,"9600":0.054,"9700":0.055,"9800":0.056,"9900":0.057,"10000":0.058,"10100":0.059,"10200":0.059,"10300":0.06,"10400":0.061,"10500":0.062,"10600":0.063,"10700":0.064,"10800":0.065,"10900":0.066,"11000":0.067,"11100":0.068,"11200":0.068,"11300":0.069,"11400":0.07,"11500":0.071,"11600":0.072,"11700":0.073,"11800":0.074,"11900":0.075,"12000":0.076,"12100":0.077,"12200":0.078,"12300":0.079,"12400":0.08,"12500":0.081,"12600":0.082,"12700":0.083,"12800":0.084,"12900":0.085,"13000":0.086,"13100":0.087,"13200":0.088,"13300":0.089,"13400":0.09,"13500":0.091,"13600":0.092,"13700":0.093,"13800":0.094,"13900":0.095,"14000":0.096,"14100":0.097,"14200":0.098,"14300":0.099,"14400":0.1,"14500":0.101,"14600":0.102,"14700":0.103,"14800":0.104,"14900":0.105,"15000":0.106,"15100":0.107,"15200":0.108,"15300":0.109,"15400":0.11,"15500":0.111,"15600":0.112,"15700":0.114,"15800":0.115,"15900":0.116,"16000":0.117,"16100":0.118,"16200":0.119,"16300":0.12,"16400":0.121,"16500":0.122,"16600":0.123,"16700":0.125,"16800":0.126,"16900":0.127,"17000":0.128,"17100":0.129,"17200":0.13,"17300":0.131,"17400":0.133,"17500":0.134,"17600":0.135,"17700":0.136,"17800":0.137,"17900":0.138,"18000":0.139,"18100":0.141,"18200":0.142,"18300":0.143,"18400":0.144,"18500":0.145,"18600":0.146,"18700":0.148,"18800":0.149,"18900":0.15,"19000":0.151,"19100":0.152,"19200":0.154,"19300":0.155,"19400":0.156,"19500":0.157,"19600":0.158,"19700":0.16,"19800":0.161,"19900":0.162,"20000":0.163,"20100":0.165,"20200":0.166,"20300":0.167,"20400":0.168,"20500":0.169,"20600":0.171,"20700":0.172,"20800":0.173,"20900":0.174,"21000":0.176,"21100":0.177,"21200":0.178,"21300":0.179,"21400":0.181,"21500":0.182,"21600":0.183,"21700":0.185,"21800":0.186,"21900":0.187,"22000":0.188,"22100":0.19,"22200":0.191,"22300":0.192,"22400":0.194,"22500":0.195,"22600":0.196,"22700":0.197,"22800":0.199,"22900":0.2,"23000":0.201,"23100":0.203,"23200":0.204,"23300":0.205,"23400":0.207,"23500":0.208,"23600":0.209,"23700":0.211,"23800":0.212,"23900":0.213,"24000":0.215,"24100":0.216,"24200":0.217,"24300":0.219,"24400":0.22,"24500":0.221,"24600":0.223,"24700":0.224,"24800":0.225,"24900":0.227,"25000":0.228,"25100":0.23,"25200":0.231,"25300":0.232,"25400":0.234,"25500":0.235,"25600":0.236,"25700":0.238,"25800":0.239,"25900":0.241,"26000":0.242,"26100":0.243,"26200":0.245,"26300":0.246,"26400":0.248,"26500":0.249,"26600":0.25,"26700":0.252,"26800":0.253,"26900":0.255,"27000":0.256,"27100":0.258,"27200":0.259,"27300":0.26,"27400":0.262,"27500":0.263,"27600":0.265,"27700":0.266,"27800":0.268,"27900":0.269,"28000":0.271,"28100":0.272,"28200":0.273,"28300":0.275,"28400":0.276,"28500":0.278,"28600":0.279,"28700":0.281,"28800":0.282,"28900":0.284,"29000":0.285,"29100":0.287,"29200":0.288,"29300":0.29,"29400":0.291,"29500":0.293,"29600":0.294,"29700":0.296,"29800":0.297,"29900":0.299,"30000":0.3}}}}

{set;~morale;{args;0}}
{set;~raidtier;{if;{argslength};==;1;4;{args;1}}}

{set;~basebonus;{switch;{get;~raidtier};
  1;0;
  2;0.05;
  3;0.1;
  4;0.15;
}}

{set;~moralebonus;0}

{//; find closest morale}
{foreach;~item;{jkeys;~moraletab;Bonus};
  {if;{parseint;{get;~item}};>;{get;~morale};
    {output;{numformat;{math;*;100;{increment;~moralebonus;{get;~basebonus};false}};2}}
    {return}
  }
  {set;~moralebonus;{parsefloat;{jget;~moraletab;Bonus.{get;~item}}}}
}